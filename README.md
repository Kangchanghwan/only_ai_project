# Image Share - 실시간 이미지 공유 애플리케이션

Socket.IO를 활용한 실시간 이미지 공유 애플리케이션입니다.

## 📋 기능

### ✅ 구현된 핵심 기능

1. **자동 룸 생성**
   - 웹 접속 시 자동으로 6자리 룸 번호 생성 (100000-999999)
   - 룸 번호가 웹에 즉시 표시됨

2. **룸 입장**
   - 다른 사용자가 생성한 룸 번호로 입장 가능
   - 실시간으로 사용자 수 확인

3. **QR 코드 공유 (NEW!)**
   - 룸 코드를 QR 코드로 생성하여 모바일 접근성 향상
   - QR 코드 스캔으로 즉시 룸 입장 가능
   - QR 코드 다운로드 기능 제공
   - URL 해시 파라미터 기반 자동 룸 연결 (예: `/#/ABC123`)

4. **실시간 통신**
   - Socket.IO 기반 양방향 실시간 통신
   - 룸 내 모든 사용자에게 즉시 메시지 브로드캐스트

5. **사용자 관리**
   - 사용자 입장/퇴장 실시간 알림
   - 빈 룸 자동 정리

## 🏗️ 프로젝트 구조

```
.
├── backend/                # Socket.IO 서버 (Node.js + TypeScript)
│   ├── src/
│   │   ├── server.ts      # 메인 서버 로직
│   │   └── __tests__/     # Jest 테스트
│   ├── package.json
│   ├── tsconfig.json
│   └── jest.config.js
│
└── frontend/              # Vue 3 클라이언트
    ├── src/
    │   ├── App.vue        # 메인 앱 컴포넌트
    │   ├── components/    # UI 컴포넌트
    │   └── composables/   # Vue 컴포저블
    │       └── useSocket.js  # Socket.IO 클라이언트
    └── package.json
```

## 🚀 시작하기

### 사전 요구사항

- Node.js 22.9.0 이상
- npm 또는 yarn

### 백엔드 서버 실행

```bash
cd backend

# 의존성 설치
npm install

# 개발 모드 실행 (hot reload)
npm run dev

# 테스트 실행
npm test

# 프로덕션 빌드
npm run build
npm start
```

서버는 **http://localhost:3001** 에서 실행됩니다.

### 프론트엔드 실행

```bash
cd frontend

# 의존성 설치
npm install

# 개발 서버 실행
npm run dev

# 프로덕션 빌드
npm run build
```

프론트엔드는 **http://localhost:5174/** 에서 실행됩니다.

## 📡 Socket.IO 이벤트

### 서버 → 클라이언트

| 이벤트 | 파라미터 | 설명 |
|-------|---------|------|
| `registered` | `roomNumber: number` | 새 룸 생성 완료, 룸 번호 반환 |
| `subscribed` | `roomNumber: number, userCount: number` | 기존 룸 입장 성공 |
| `room-not-found` | - | 존재하지 않는 룸 입장 시도 |
| `message` | `msg: any` | 룸 내 메시지 수신 |
| `user-left` | `userCount: number` | 사용자 퇴장 알림 |

### 클라이언트 → 서버

| 이벤트 | 파라미터 | 설명 |
|-------|---------|------|
| `join` | `roomNumber: number` | 기존 룸 입장 요청 |
| `publish` | `message: any` | 룸에 메시지 전송 |

## 🎯 사용 흐름

### 1. 새 룸 생성

1. 웹 브라우저에서 http://localhost:5174/ 접속
2. "새 룸 생성" 버튼 클릭
3. **자동으로 생성된 6자리 룸 번호가 화면에 표시됨**
4. 이 번호를 다른 사용자와 공유

### 2. 기존 룸 입장

#### 방법 1: 수동 입력
1. 웹 브라우저에서 http://localhost:5174/ 접속
2. "룸 입장" 버튼 클릭
3. 공유받은 6자리 룸 번호 입력
4. 입장하면 현재 룸에 있는 사용자 수 표시

#### 방법 2: QR 코드 스캔 (모바일 접근성)
1. PC에서 룸 코드 옆의 "QR" 버튼 클릭
2. 표시된 QR 코드를 모바일 기기로 스캔
3. 자동으로 해당 룸에 입장
4. QR 코드 다운로드도 가능

### 3. 이미지 공유 (예정)

- Ctrl+V (Mac: Cmd+V)로 클립보드 이미지 업로드
- 업로드된 이미지는 같은 룸의 모든 사용자에게 실시간 표시

## 📝 개발 로드맵

### Phase 1: 핵심 기능 강화 (우선순위: 높음)

#### 1. 파일 크기 제한 및 예외처리
- **목표**: 서버 과부하 방지 및 안정성 확보
- **구현 내용**:
  - 클라이언트: 업로드 전 파일 크기 사전 검증 (즉시 피드백)
  - 백엔드: Socket.IO `maxHttpBufferSize` 설정
  - 권장 제한: 5-10MB per file
  - 사용자 친화적 에러 메시지 표시

#### 2. 파일 업로드 UI 개선
- **목표**: 다양한 업로드 방식 지원으로 접근성 향상
- **구현 내용**:
  - ✅ 클립보드 붙여넣기 (Ctrl/Cmd+V)
  - 파일 선택 버튼 (`<input type="file" multiple>`)
  - 드래그 앤 드롭 영역
  - 업로드 방법 안내 UI

#### 3. 닫힌 룸 리소스 정리 전략
- **목표**: 메모리 효율성과 사용자 경험 균형
- **구현 방법 검토**:
  - **옵션 A**: 즉시 정리 (현재 방식)
    - 마지막 사용자 퇴장 시 바로 삭제
    - 장점: 메모리 효율적
    - 단점: 재접속 시 데이터 손실
  - **옵션 B**: 지연 정리 (권장)
    - 마지막 사용자 퇴장 후 10분 대기
    - 재접속 시 데이터 유지
    - 타임아웃 후 자동 삭제
  - **옵션 C**: 하이브리드
    - 텍스트/작은 파일: 30분 유지
    - 큰 파일: 5분 유지
- **추가 고려사항**: 임시 파일 디스크 정리, TTL 설정

#### 4. 보안 및 파일 검증
- **목표**: 악성 파일 차단 및 시스템 보호
- **구현 내용**:
  - 허용 파일 타입 화이트리스트 (이미지, 문서, 압축파일 등)
  - 위험 확장자 차단 (.exe, .bat, .sh, .scr 등)
  - 파일명 sanitization (경로 조작 공격 방지)
  - MIME 타입 검증
  - XSS 방지를 위한 파일 콘텐츠 검사

#### 5. 다중 파일 다운로드
- **목표**: 여러 파일을 편리하게 저장
- **구현 내용**:
  - 파일 목록에 체크박스 UI
  - 개별 파일 다운로드 버튼
  - ZIP 압축 일괄 다운로드 (JSZip 라이브러리)
  - "선택 항목 다운로드" 및 "전체 다운로드" 버튼

### Phase 2: 사용성 개선 (우선순위: 중간)

#### 6. 업로드 파일 수 제한
- **목표**: 네트워크 부하 및 메모리 관리
- **구현 내용**:
  - 동시 업로드 최대 수 제한 (예: 10개)
  - 룸당 총 파일 수 제한 (예: 100개)
  - FIFO 방식 자동 정리 옵션
  - 제한 도달 시 명확한 안내 메시지

#### 7. 텍스트 공유 기능
- **목표**: 파일과 함께 메시지/설명 공유
- **구현 내용**:
  - 텍스트 입력창 추가
  - 메시지 타입 구분 (text, file, image)
  - 파일 + 텍스트 동시 전송
  - 타임스탬프 및 발신자 표시

#### 8. 파일 메타데이터 표시
- **목표**: 파일 정보를 명확하게 제공
- **구현 내용**:
  - 파일명, 크기, 타입
  - 업로드 시간
  - 업로더 정보 (익명 ID 또는 닉네임)
  - 파일 타입별 아이콘

#### 9. 에러 처리 및 사용자 피드백
- **목표**: 안정성 향상 및 명확한 상태 표시
- **구현 내용**:
  - 네트워크 연결 끊김 감지 및 자동 재연결
  - 업로드 실패 시 재시도 옵션
  - 로딩 상태 인디케이터
  - Toast 알림으로 상태 피드백

### Phase 3: 고급 기능 (우선순위: 낮음-중간)

#### 10. 파일 미리보기
- 이미지: 썸네일 및 전체 미리보기
- 텍스트/코드: 내용 미리보기 (syntax highlighting)
- PDF: 첫 페이지 미리보기
- 비디오: 썸네일 생성

#### 11. 업로드/다운로드 진행 상황
- 진행률 바 (percentage)
- 전송 속도 표시 (MB/s)
- 남은 시간 예측
- 취소 버튼

#### 12. 사용자 경험 개선
- 닉네임 설정 기능
- 파일 개별 삭제 기능
- 룸 비밀번호 설정 (선택적 보안)
- 룸 초대 링크 생성 및 복사
- 파일 검색 및 필터링

#### 13. 성능 최적화
- 대용량 이미지 자동 압축
- Lazy loading (파일 목록)
- Virtual scroll (많은 파일 처리)
- Web Worker 활용 (파일 처리)
- 이미지 포맷 최적화 (WebP 변환)

#### 14. 접근성 및 반응형
- 모바일 최적화 (터치 제스처)
- 키보드 단축키 지원
- 스크린 리더 호환성
- 다크 모드
- 다국어 지원 (i18n)

## 🧪 테스트

백엔드는 TDD(Test-Driven Development) 방식으로 개발되었습니다.

```bash
cd backend

# 전체 테스트 실행
npm test

# 테스트 감시 모드
npm run test:watch

# 커버리지 확인
npm run test:coverage
```

### 테스트 커버리지

- ✅ 룸 생성 플로우
- ✅ 룸 입장 플로우
- ✅ 메시지 브로드캐스팅
- ✅ 사용자 퇴장 처리

## 🛠️ 기술 스택

### 백엔드
- **Node.js** - 런타임 환경
- **TypeScript** - 타입 안전성
- **Socket.IO** - 실시간 양방향 통신
- **Express** - HTTP 서버
- **Jest** - 테스트 프레임워크

### 프론트엔드
- **Vue 3** - 프론트엔드 프레임워크
- **Vite** - 빌드 도구
- **Socket.IO Client** - 실시간 통신 클라이언트

## 🔧 환경 설정

### 백엔드 (.env)

```env
PORT=3001
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5174
```

### 프론트엔드 (.env)

```env
VITE_SOCKET_URL=http://localhost:3001
```

## 📝 개발 원칙

1. **TDD (Test-Driven Development)**
   - 테스트 먼저 작성
   - 테스트를 통과하는 최소한의 코드 작성
   - 리팩토링

2. **타입 안전성**
   - TypeScript strict 모드
   - 명확한 인터페이스 정의

3. **관심사 분리**
   - RoomManager 클래스로 룸 로직 캡슐화
   - Vue Composables로 기능 모듈화

4. **에러 처리**
   - Promise 기반 비동기 처리
   - 타임아웃 설정
   - 명확한 에러 메시지

## 🐛 트러블슈팅

### 포트가 이미 사용 중인 경우

```bash
# 백엔드 (3001 포트)
lsof -ti:3001 | xargs kill -9

# 프론트엔드 (5174 포트)
lsof -ti:5174 | xargs kill -9
```

### Socket.IO 연결 오류

1. 백엔드 서버가 실행 중인지 확인
2. CORS 설정 확인 (backend/.env)
3. 브라우저 콘솔에서 연결 상태 확인

## 📄 라이선스

ISC

## 👥 기여

프로젝트 개선을 위한 이슈 및 풀 리퀘스트를 환영합니다!
